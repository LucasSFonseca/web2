<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="Dashboard">
  <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
  <title>Books Here</title>

  <!-- Favicons -->
  <link href="img/favicon.png" th:href="@{/img/favicon.png}"  rel="icon">
  <link href="img/apple-touch-icon.png" th:href="@{/img/apple-touch-icon.png}" rel="apple-touch-icon">

  <!-- Bootstrap core CSS -->
  <link href="lib/bootstrap/css/bootstrap.min.css" th:href="@{/lib/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
  <!--external css-->
  <link href="lib/font-awesome/css/font-awesome.css" th:href="@{/lib/font-awesome/css/font-awesome.css}" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="css/zabuto_calendar.css" th:href="@{/css/zabuto_calendar.css}">
  <link rel="stylesheet" type="text/css" href="lib/gritter/css/jquery.gritter.css" th:href="@{/lib/gritter/css/jquery.gritter.css}" />
  <!-- Custom styles for this template -->
  <link href="css/style.css" th:href="@{/css/style.css}" rel="stylesheet">
  <link href="css/style-responsive.css" th:href="@{/css/style-responsive.css}"  rel="stylesheet">
  <script src="lib/chart-master/Chart.js" th:src="@{/lib/chart-master/Chart.js}"></script>

  <!-- =======================================================
    Template Name: Dashio
    Template URL: https://templatemag.com/dashio-bootstrap-admin-template/
    Author: TemplateMag.com
    License: https://templatemag.com/license/
  ======================================================= -->
</head>

<body>
  <section id="container">
    
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <header class="header black-bg">
      <div data-th-replace="fragments/top-bar-content-fragment :: top-bar-content"></div>
    </header>
    <!--header end-->
    
    
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <aside>
      <div data-th-replace="fragments/side-bar-menu-fragment :: side-bar-menu"></div>
    </aside>
    <!--sidebar end-->
    
    
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    
    <!--main content start-->
    <section id="main-content">
      <section class="wrapper site-min-height">
      
        <div th:if="${success != null}" class="alert alert-success" role="alert"><span th:text="${success}">msg success</span></div>
		<div th:if="${error != null}" class="alert alert-danger" role="alert"><span th:text="${error}">msg error</span></div>
        
        <div layout:fragment="content">
		  <p>Page content goes here</p>
		</div>
    
      </section>
      
   		<!-- Modal -->
	    <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade">
	      <div class="modal-dialog">
	        <div class="modal-content">
	          <div class="modal-header">
	            <h4 class="modal-title">Apagar Livro</h4>
	            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	          </div>
	          <div class="modal-body">
	            <p>Deseja realmente apagar este livro ?</p>
	          </div>
	          <div class="modal-footer">
	            <button data-dismiss="modal" class="btn btn-default" type="button">Cancel</button>
	            <a id="thingId" class="btn btn-danger">Excluir</a>
	          </div>
	        </div>
	      </div>
	    </div>
	    <!-- modal -->
	    
    </section>
    <!--main content end-->
 
    
    <!--footer start-->
    <footer class="site-footer">
      <div class="text-center">
        <p>
          &copy; Copyrights <strong>Dashio</strong>. All Rights Reserved
        </p>
        <div class="credits">
          Created with Dashio template by <a href="https://templatemag.com/">TemplateMag</a>
        </div>
        <a href="#" class="go-top">
        <i class="fa fa-angle-up"></i>
        </a>
      </div>
    </footer>
    <!--footer end-->
  
  </section>
  
  <!-- js placed at the end of the document so the pages load faster -->
  <script src="lib/jquery/jquery.min.js" th:src="@{/lib/jquery/jquery.min.js}"></script>

  <script src="lib/bootstrap/js/bootstrap.min.js" th:src="@{/lib/bootstrap/js/bootstrap.min.js}"></script>
  <script class="include" type="text/javascript" src="lib/jquery.dcjqaccordion.2.7.js" th:src="@{/lib/jquery.dcjqaccordion.2.7.js}"></script>
  <script src="lib/jquery.scrollTo.min.js" th:src="@{/lib/jquery.scrollTo.min.js}"></script>
  <script src="lib/jquery.nicescroll.js" th:src="@{/lib/jquery.nicescroll.js}" type="text/javascript"></script>
  <script src="lib/jquery.sparkline.js" th:src="@{/lib/jquery.sparkline.js}"></script>
  <!--common script for all pages-->
  <script src="lib/common-scripts.js" th:src="@{/lib/common-scripts.js}"></script>
  <script type="text/javascript" src="lib/gritter/js/jquery.gritter.js" th:src="@{/lib/gritter/js/jquery.gritter.js}"></script>
  <script type="text/javascript" src="lib/gritter-conf.js" th:src="@{/lib/gritter-conf.js}"></script>  
  
  <script>

		$(document).on("click", ".open-RemoveBookDialog", function () {
			
		     var myThingId = $(this).data('id');
		 	 var url = [[@{/books/}]] + myThingId + "/delete/";
		     $(".modal-footer #thingId").attr("href", url); 
		});
		

		$(document).on("click", ".open-RemoveCollectionDialog", function () {
			
		     var myThingId = $(this).data('id');
		 	 var url = [[@{/collections/}]] + myThingId + "/delete/";
		     $(".modal-footer #thingId").attr("href", url); 
		});
		

		$(document).on("click", ".open-RemoveWishListDialog", function () {
			
		     var myThingId = $(this).data('id');
		 	 var url = [[@{/wishLists/}]] + myThingId + "/delete/";
		     $(".modal-footer #thingId").attr("href", url); 
		});
		
		$(document).on("click", "#searchBook", function ()
		{
			// Set the api variable
			var isbn = document.getElementById("ISBN").value;
			
			$.ajax({
				  dataType: 'json',
				  url: 'https://www.googleapis.com/books/v1/volumes?q=isbn:' + isbn,
				  success: handleResponse
				  // TODO: Add mensagem para caso nÃ£o encontre.
				});     
		});
		
		function handleResponse( response )
		{
			  $.each( response.items, function( i, item ) 
			  {				    				    
			    var title = item.volumeInfo.title;
			    
			    if( item.volumeInfo.subtitle != null )
			    	title += " " + item.volumeInfo.subtitle;

			   	if( title.length > 255 )
			   		title = title.substring(0, 252) + "...";
			   	
			    var authors = item.volumeInfo.authors;

			   	if( authors.length > 255 )
			   		authors = authors.substring(0, 252) + "...";
			    
			    var publishedDate = item.volumeInfo.publishedDate;
			    
			    if( item.volumeInfo.imageLinks != null )  
				    var thumbnail = item.volumeInfo.imageLinks.thumbnail;
				    
			   	var language = item.volumeInfo.language;
			   	
			   	var description = item.volumeInfo.description;
			   	
			   	if( description.length > 255 )
			   		description = description.substring(0, 252) + "...";
			   	
			    // Set the book title in the div
			    document.getElementById("titulo").value =title;
			    document.getElementById("autor").value = authors;
			    document.getElementById("data_publicacao").value = publishedDate;
			    document.getElementById("thumbnail").value = thumbnail;
			    document.getElementById("idioma").value = language;
			    document.getElementById("descricao").value = description;
			  });
		}
		
  </script>
  
</body>

</html>
